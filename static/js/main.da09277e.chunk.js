(this["webpackJsonpcanvas-app"]=this["webpackJsonpcanvas-app"]||[]).push([[0],{21:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),s=n(11),o=n.n(s),i=(n(21),n(9)),r=n.n(i),u=n(12),l=n(3),f=(n(23),n(16)),h=n(14),b=n(15),v=(n(24),n(6)),d=n(7);var j=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},m=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"black",s=arguments.length>4?arguments[4]:void 0;Object(v.a)(this,t),this._xLoc=void 0,this._yLoc=void 0,this._scale=1,this._path=void 0,this._color=void 0,this._id=void 0,this._dClickX=0,this._dClickY=0,this._svg=void 0,this._path=new Path2D(e),this._svg=e,this._xLoc=n,this._yLoc=a,this._color=c,this._movePath(),this._id=s||j()}return Object(d.a)(t,[{key:"id",get:function(){return this._id}},{key:"color",get:function(){return this._color}},{key:"path",get:function(){return this._path}},{key:"scale",get:function(){return this._scale}},{key:"xLoc",get:function(){return this._xLoc}},{key:"yLoc",get:function(){return this._yLoc}},{key:"_movePath",value:function(t,e){var n=new DOMMatrix;n.e="undefined"!==typeof t?t-this._xLoc:this._xLoc,n.f="undefined"!==typeof e?e-this._yLoc:this._yLoc,n.e-=this._dClickX,n.f-=this._dClickY;var a=new Path2D;a.addPath(this._path,n),this._path=a}},{key:"setClickStartingPoint",value:function(t,e){this._dClickX=t-this._xLoc,this._dClickY=e-this._yLoc}},{key:"clearClickStartingPoint",value:function(){this._dClickX=0,this._dClickY=0}},{key:"moveItem",value:function(t,e){this._movePath(t,e),this._xLoc=t-this._dClickX,this._yLoc=e-this._dClickY}},{key:"getState",value:function(){return{svg:this._svg,xLoc:this._xLoc,yLoc:this._yLoc,color:this._color}}},{key:"restoreState",value:function(t){this._movePath(t.xLoc,t.yLoc),this._xLoc=t.xLoc,this._yLoc=t.yLoc}}],[{key:"restoreItem",value:function(e,n){return new t(e.svg,e.xLoc,e.yLoc,e.color,n)}}]),t}(),y=(n(25),n(2)),p=n(1);var O=function(t){var e=t.items,n=t.setItems,c=t.selectedItems,s=t.setSelectedItems,o=t.history,i=Object(b.a)(t,["items","setItems","selectedItems","setSelectedItems","history"]),r=Object(a.useState)([0,0]),u=Object(l.a)(r,2),v=u[0],d=u[1],j=Object(a.useState)(!1),O=Object(l.a)(j,2),x=O[0],k=O[1],g=Object(a.useState)(),_=Object(l.a)(g,2),S=_[0],C=_[1],L=Object(a.useRef)(null),w=Object(a.useCallback)((function(){var t=L.current,e=t.getContext("2d");return{canvas:t,context:e}}),[L]),I=Object(a.useCallback)((function(){var t=w(),n=t.context,a=t.canvas;n.clearRect(0,0,a.width,a.height),Array.from(e.values()).forEach((function(t){return e=t,n.beginPath(),n.fillStyle=e.color,n.shadowColor=e.color,n.shadowBlur=c.has(e.id)?16:0,n.fill(e.path),void n.closePath();var e}))}),[w,e,c]),E=Object(a.useCallback)((function(){C(window.setInterval((function(){I()}),17))}),[I]),M=Object(a.useCallback)((function(){o.saveState(e)}),[o,e]);Object(a.useLayoutEffect)((function(){v[0]&&v[1]&&c.forEach((function(t){t.setClickStartingPoint.apply(t,Object(h.a)(v))}))}),[c,v,I]);var A=Object(a.useCallback)((function(){window.clearInterval(S),I()}),[S,I]),N=Object(a.useCallback)((function(t){if(t){for(var e=Object(y.a)(),a=function(){var n=s[c],a=t.get(n);e=e.withMutations((function(t){return t.set(n,m.restoreItem(a,n))}))},c=0,s=Array.from(t.keys());c<s.length;c++)a();n(e)}}),[n]),P=Object(a.useCallback)((function(){o.cleanHistory(),N(o.defaultSnapshot)}),[o,N]),D=Object(a.useCallback)((function(){N(o.getRecentStates())}),[o,N]),F=Object(a.useCallback)((function(){D(),I()}),[I,D]),X=Object(a.useCallback)((function(){P(),I()}),[I,P]);Object(a.useEffect)((function(){I()}),[e,o,I]);var Y=Object(a.useCallback)((function(t,n,a){for(var c=w().context,s=0,o=Array.from(e.values());s<o.length;s++){var i=o[s];if(c.isPointInPath(i.path,t.offsetX,t.offsetY))return n(t,i)}a&&a(t)}),[e,w]),J=Object(a.useCallback)((function(t){M(),d([t.offsetX,t.offsetY]),k(!0),E()}),[M,E]),R=Object(a.useCallback)((function(t){x&&c.forEach((function(e){e.moveItem(t.offsetX,t.offsetY)}))}),[x,c]),B=Object(a.useCallback)((function(t){if(t.ctrlKey)return Y(t,(function(t,e){s(c.set(e.id,e)),J(t)}));Y(t,(function(t,e){var n=c.clear();s(n.set(e.id,e)),J(t)}),(function(){s(c.clear())}))}),[Y,c,s,J]),H=Object(a.useCallback)((function(){c.forEach((function(t){return t.clearClickStartingPoint()})),k(!1),A(),d([0,0])}),[c,A]);return Object(a.useEffect)((function(){var t=w().canvas;return t.addEventListener("mousedown",B),t.addEventListener("mouseup",H),t.addEventListener("mousemove",R),function(){window.clearInterval(S),t.removeEventListener("mousedown",B),t.removeEventListener("mouseup",H),t.removeEventListener("mousemove",R)}}),[w,B,R,H,S]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"canvas-container",children:Object(p.jsx)("canvas",Object(f.a)({height:700,width:700,ref:L},i))}),Object(p.jsxs)("div",{className:"buttons-container",children:[Object(p.jsx)("button",{className:"ctrl-button",onClick:F,children:"Undo"}),Object(p.jsx)("button",{className:"ctrl-button",onClick:X,children:"Reset"})]})]})},x=n(13),k=function(){function t(e){Object(v.a)(this,t),this._history=[],this._defaultSnapshot=Object(y.a)().asMutable(),e&&this.setDefaultSnapshot(e)}return Object(d.a)(t,[{key:"saveState",value:function(t){for(var e=Object(y.a)().asMutable(),n=0,a=Array.from(t.keys());n<a.length;n++){var c=a[n],s=t.get(c);s&&e.set(c,s.getState())}this._history.push(e)}},{key:"getRecentStates",value:function(){return this._history.pop()}},{key:"setDefaultSnapshot",value:function(t){for(var e=Object(y.a)().asMutable(),n=0,a=Array.from(t.keys());n<a.length;n++){var c=a[n],s=t.get(c);s&&e.set(c,s.getState())}this._defaultSnapshot=e}},{key:"updateDefaultSnapshot",value:function(t){var e,n=Object(x.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;this._defaultSnapshot.has(a.id)||this._defaultSnapshot.set(a.id,a.getState())}}catch(c){n.e(c)}finally{n.f()}}},{key:"defaultSnapshot",get:function(){return this._defaultSnapshot}},{key:"clearDefaultSnapshot",value:function(){this._defaultSnapshot.clear()}},{key:"cleanHistory",value:function(){this._history=[]}},{key:"isHistoryEmpty",value:function(){return!this._history.length}}]),t}(),g=n(10),_=n.n(g),S=function(){return[new m("M 0 0 L 40 5 V 145",0,0,"red"),new m("M 100 100 V 0 H 200 V 100",150,150),new m("M 0 0 A 25 25 90 0 0 25 50 A 25 25 90 0 0 0 0",200,350,"green"),new m("M 0 131.25 L 105 131.25 L 52.5 26.25",500,410,"blue"),new m("M 0 0 L 192.5 0 C 157.5 23.3327 70 0 87.5 70",400,400,"orange"),new m("M 0 0 A 33.6 33.6 90 0 0 0 134.4",500,500,"darkcyan"),new m("M 0 0 V 144 Q 96 96 192 192",600,10,"yellow")]};var C=function(){var t=Object(a.useMemo)((function(){var t=localStorage.getItem("defaultState"),e=Object(y.a)();t&&JSON.parse(t).forEach((function(t){var n=m.restoreItem(t);e=e.withMutations((function(t){return t.set(n.id,n)}))}));return e}),[]),e=Object(a.useState)(t),n=Object(l.a)(e,2),c=n[0],s=n[1],o=Object(a.useState)(Object(y.a)()),i=Object(l.a)(o,2),f=i[0],h=i[1],b=Object(a.useMemo)((function(){return new k(c)}),[]),v=Object(a.useCallback)((function(t){t.preventDefault();var e=new FileReader;e.onload=function(){var e=Object(u.a)(r.a.mark((function e(n){var a,o,i,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===n||void 0===n?void 0:n.target)&&(a=n.target.result,o=JSON.parse(a),b.saveState(c),i=o.map((function(t){return m.restoreItem(t)})),u=c.asImmutable(),i.forEach((function(t){return u=u.withMutations((function(e){return e.set(t.id,t)}))})),s(u),t.target.value="");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=t.target.files;e.readAsText(n[0])}),[b,c]),d=Object(a.useCallback)((function(){var t=Array.from(f.values()),e=JSON.stringify(t.map((function(t){return t.getState()}))),n=new Blob([e],{type:"application/json"});_.a.saveAs(n,"items.json")}),[f]),j=Object(a.useCallback)((function(){var t=JSON.stringify(c.map((function(t){return t.getState()}))),e=new Blob([t],{type:"application/json"});_.a.saveAs(e,"items.json")}),[c]),x=Object(a.useCallback)((function(){var t=S(),e=c.asImmutable();t.forEach((function(t){return e=e.withMutations((function(e){return e.set(t.id,t)}))})),s(e)}),[c]),g=Object(a.useCallback)((function(){var t=JSON.stringify(Array.from(c.values()).map((function(t){return t.getState()})));b.setDefaultSnapshot(c),localStorage.setItem("defaultState",t)}),[b,c]),C=Object(a.useCallback)((function(){b.clearDefaultSnapshot(),localStorage.removeItem("defaultState")}),[b]),L=Object(a.useCallback)((function(t){"Delete"!==t.key||f.isEmpty()||(b.saveState(c),s(c.deleteAll(f.keys())),h(f.clear()))}),[b,c,f]);return Object(a.useEffect)((function(){return window.addEventListener("keypress",L),function(){return window.removeEventListener("keypress",L)}}),[L]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("div",{className:"import-export-container",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{htmlFor:"import-item",className:"ctrl-button",children:"Import"}),Object(p.jsx)("input",{id:"import-item",type:"file",className:"display-none",onChange:v})]}),Object(p.jsx)("button",{onClick:d,className:"ctrl-button",children:"Export"}),Object(p.jsx)("button",{onClick:j,className:"ctrl-button",children:"Export All"}),Object(p.jsx)("button",{className:"ctrl-button",onClick:x,children:"Add Default Figures"}),Object(p.jsx)("button",{onClick:g,className:"ctrl-button",children:"Save As Default"}),Object(p.jsx)("button",{onClick:C,className:"ctrl-button",children:"Clear Default"})]}),Object(p.jsx)(O,{selectedItems:f,setSelectedItems:h,items:c,setItems:s,history:b}),Object(p.jsx)("div",{style:{marginTop:"16px",display:"flex",gap:"16px"}})]})},L=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,s=e.getLCP,o=e.getTTFB;n(t),a(t),c(t),s(t),o(t)}))};o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(C,{})}),document.getElementById("root")),L()}},[[28,1,2]]]);
//# sourceMappingURL=main.da09277e.chunk.js.map