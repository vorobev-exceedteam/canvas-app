{"version":3,"sources":["models/CanvasItemHistory.ts","Canvas/index.tsx","models/CanvasItemModel.ts","models/MockItems.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["_history","_defaultSnapshot","Map","items","itemsStates","forEach","item","key","set","getState","this","push","pop","length","Canvas","rest","useState","selectedItem","setSelectedItem","clickedCord","setClickedCord","rerenderInterval","setRerenderInterval","canvasRef","useRef","getCanvasContext","useCallback","canvas","current","context","getContext","drawObjects","clearRect","width","height","object","beginPath","fillStyle","color","fill","path","closePath","start","window","setInterval","save","CanvasItemHistory","saveState","undo","states","getRecentStates","state","get","restoreState","stop","clearInterval","reset","cleanHistory","defaultSnapshot","handleUndo","handleReset","useEffect","setDefaultSnapshot","onMouseMove","event","moveItem","offsetX","offsetY","onMouseDown","isPointInPath","xLoc","yLoc","onMouseUp","addEventListener","removeEventListener","className","ref","onClick","CanvasItemModel","x","y","_xLoc","_yLoc","_scale","_path","_color","_movePath","dClickedX","dClickedY","transformMatrix","DOMMatrix","e","f","Path2D","addPath","rectang1","rect","circl1","arc","Math","PI","circl2","circl3","eleps","ellipse","eleps2","mockItems","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8eee448b.chunk.js","sourcesContent":["import CanvasItemModel from './CanvasItemModel';\nimport { CanvasItemState } from '../types';\n\nclass CanvasItemHistory {\n  private _history: Map<number, CanvasItemState>[] = [];\n  private _defaultSnapshot: Map<number, CanvasItemState> = new Map<\n    number,\n    CanvasItemState\n  >();\n\n  saveState(items: CanvasItemModel[]) {\n    const itemsStates = new Map<number, CanvasItemState>();\n    items.forEach((item, key) => {\n      itemsStates.set(key, item.getState());\n    });\n    this._history.push(itemsStates);\n  }\n\n  getRecentStates() {\n    return this._history.pop();\n  }\n\n  setDefaultSnapshot(items: CanvasItemModel[]) {\n    const itemsStates = new Map<number, CanvasItemState>();\n    items.forEach((item, key) => {\n      itemsStates.set(key, item.getState());\n    });\n    this._defaultSnapshot = itemsStates;\n  }\n\n  get defaultSnapshot() {\n    return this._defaultSnapshot;\n  }\n\n  cleanHistory() {\n    this._history = [];\n  }\n\n  isHistoryEmpty() {\n    return !this._history.length;\n  }\n}\n\nexport default new CanvasItemHistory();\n","import {\n  HTMLAttributes,\n  useCallback,\n  useEffect,\n  useRef,\n  useState\n} from 'react';\nimport './styles.scss';\nimport CanvasItemModel from '../models/CanvasItemModel';\nimport CanvasItemHistory from '../models/CanvasItemHistory';\nimport 'normalize.css';\n\ninterface CanvasProps extends HTMLAttributes<HTMLCanvasElement> {\n  items: CanvasItemModel[];\n}\n\nfunction Canvas({ items, ...rest }: CanvasProps): JSX.Element {\n  const [selectedItem, setSelectedItem] = useState<CanvasItemModel | null>(\n    null\n  );\n  const [clickedCord, setClickedCord] = useState<[number, number]>([0, 0]);\n\n  const [rerenderInterval, setRerenderInterval] = useState<number>();\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const getCanvasContext = useCallback(() => {\n    const canvas = canvasRef.current as HTMLCanvasElement;\n    const context = canvas.getContext('2d') as CanvasRenderingContext2D;\n    return { canvas, context };\n  }, [canvasRef]);\n\n  const drawObjects = useCallback(() => {\n    const { context, canvas } = getCanvasContext();\n\n    function drawObject(object: CanvasItemModel): void {\n      context.beginPath();\n      context.fillStyle = object.color;\n      context.fill(object.path);\n      context.closePath();\n    }\n\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    items.forEach((item) => drawObject(item));\n  }, [items, getCanvasContext]);\n\n  const start = useCallback(() => {\n    setRerenderInterval(\n      window.setInterval(() => {\n        drawObjects();\n      }, 17)\n    );\n  }, [drawObjects]);\n\n  const save = useCallback(() => {\n    CanvasItemHistory.saveState(items);\n  }, [items]);\n\n  const undo = useCallback(() => {\n    const states = CanvasItemHistory.getRecentStates();\n    items.forEach((item, key) => {\n      const state = states?.get(key);\n      if (state) {\n        item.restoreState(state);\n      }\n    });\n  }, [items]);\n\n  const stop = useCallback(() => {\n    window.clearInterval(rerenderInterval);\n    drawObjects();\n  }, [rerenderInterval, drawObjects]);\n\n  const reset = useCallback(() => {\n    CanvasItemHistory.cleanHistory();\n    const states = CanvasItemHistory.defaultSnapshot;\n    items.forEach((item, key) => {\n      const state = states?.get(key);\n      if (state) {\n        item.restoreState(state);\n      }\n    });\n  }, [items]);\n\n  const handleUndo = useCallback(() => {\n    undo();\n    drawObjects();\n  }, [drawObjects, undo]);\n\n  const handleReset = useCallback(() => {\n    reset();\n    drawObjects();\n  }, [drawObjects, reset]);\n\n  useEffect(() => {\n    drawObjects();\n    CanvasItemHistory.setDefaultSnapshot(items);\n  }, []);\n\n  useEffect(() => {\n    const { canvas, context } = getCanvasContext();\n\n    function onMouseMove(event: MouseEvent) {\n      if (selectedItem) {\n        selectedItem.moveItem(event.offsetX, event.offsetY, ...clickedCord);\n      }\n    }\n\n    function onMouseDown(event: MouseEvent) {\n      for (let item of items) {\n        if (context.isPointInPath(item.path, event.offsetX, event.offsetY)) {\n          save();\n          setClickedCord([\n            event.offsetX - item.xLoc,\n            event.offsetY - item.yLoc\n          ]);\n          setSelectedItem(item);\n          start();\n          break;\n        }\n      }\n    }\n\n    function onMouseUp() {\n      stop();\n      setSelectedItem(null);\n      setClickedCord([0, 0]);\n    }\n\n    canvas.addEventListener('mousedown', onMouseDown);\n    canvas.addEventListener('mouseup', onMouseUp);\n    canvas.addEventListener('mousemove', onMouseMove);\n\n    return function () {\n      window.clearInterval(rerenderInterval);\n      canvas.removeEventListener('mousedown', onMouseDown);\n      canvas.removeEventListener('mouseup', onMouseUp);\n      canvas.removeEventListener('mousemove', onMouseMove);\n    };\n  }, [\n    items,\n    clickedCord,\n    drawObjects,\n    getCanvasContext,\n    rerenderInterval,\n    save,\n    selectedItem,\n    setSelectedItem,\n    start,\n    stop\n  ]);\n\n  return (\n    <>\n      <div className={'canvas-container'}>\n        <canvas height={700} width={700} ref={canvasRef} {...rest} />\n      </div>\n      <div className={'buttons-container'}>\n        <button onClick={handleUndo}>Undo</button>\n        <button onClick={handleReset}>Reset</button>\n      </div>\n    </>\n  );\n}\n\nexport default Canvas;\n","import { CanvasItemState } from '../types';\n\nclass CanvasItemModel {\n  private _xLoc: number;\n  private _yLoc: number;\n  private _scale: number = 1;\n  private _path: Path2D;\n  private readonly _color: string;\n\n  constructor(path: Path2D, x: number = 0, y: number = 0, color = 'black') {\n    this._path = path;\n    this._xLoc = x;\n    this._yLoc = y;\n    this._color = color;\n    this._movePath();\n  }\n\n  get color(): string {\n    return this._color;\n  }\n\n  get path(): Path2D {\n    return this._path;\n  }\n\n  get scale(): number {\n    return this._scale;\n  }\n\n\n  get xLoc(): number {\n    return this._xLoc;\n  }\n\n  get yLoc(): number {\n    return this._yLoc;\n  }\n\n  private _movePath(\n    x?: number,\n    y?: number,\n    dClickedX?: number,\n    dClickedY?: number\n  ) {\n    const transformMatrix = new DOMMatrix();\n    transformMatrix.e = typeof x !== 'undefined' ? x - this._xLoc : this._xLoc;\n    transformMatrix.f = typeof y !== 'undefined' ? y - this._yLoc : this._yLoc;\n    if (dClickedX) {\n      transformMatrix.e -= dClickedX;\n    }\n    if (dClickedY) {\n      transformMatrix.f -= dClickedY;\n    }\n    const path = new Path2D();\n    path.addPath(this._path, transformMatrix);\n    this._path = path;\n  }\n\n  moveItem(x: number, y: number, dClickedX: number, dClickedY: number) {\n    this._movePath(x, y, dClickedX, dClickedY);\n    this._xLoc = x - dClickedX;\n    this._yLoc = y - dClickedY;\n  }\n\n  getState() {\n    return { xLoc: this._xLoc, yLoc: this._yLoc };\n  }\n\n  restoreState(state: CanvasItemState) {\n    this._movePath(state.xLoc, state.yLoc);\n    this._xLoc = state.xLoc;\n    this._yLoc = state.yLoc;\n  }\n}\n\nexport default CanvasItemModel;\n","import CanvasItemModel from './CanvasItemModel';\n\nconst rectang1 = new Path2D();\nrectang1.rect(0, 0, 100, 100);\nconst circl1 = new Path2D();\ncircl1.arc(50, 40, 50, 0, 2 * Math.PI);\nconst circl2 = new Path2D();\ncircl2.arc(0, 0, 70, 0, 2 * Math.PI);\nconst circl3 = new Path2D();\ncircl3.arc(0, 0, 70, 0,  Math.PI);\nconst eleps = new Path2D();\neleps.ellipse(0, 0, 30, 70, Math.PI / 4, 0, 2 * Math.PI);\nconst eleps2 = new Path2D();\neleps2.ellipse(0, 0, 60, 70, Math.PI / 2, 0, 2 * Math.PI);\n\nconst mockItems: CanvasItemModel[] = [\n  new CanvasItemModel(rectang1, 0, 0, 'red'),\n  new CanvasItemModel(circl1, 150, 150),\n  new CanvasItemModel(circl2, 200, 350, 'green'),\n  new CanvasItemModel(circl1, 500, 410, 'blue'),\n  new CanvasItemModel(eleps, 400, 400, 'orange'),\n  new CanvasItemModel(eleps2, 500, 500, 'darkcyan'),\n  new CanvasItemModel(circl3, 600, 10, 'yellow')\n];\n\nexport default mockItems\n","import './App.scss';\nimport Canvas from './Canvas';\nimport mockItems from './models/MockItems';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Canvas\n        items={mockItems}\n      />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}